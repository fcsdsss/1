<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- ... 头部代码保持不变 ... -->
</head>
<body>
    <div class="container">
        <h2>绕过 URL</h2>
        <input type="text" id="urlInput" placeholder="在此输入 URL">
        <div class="button-group">
            <button onclick="bypassUrl()">绕过</button>
            <button onclick="clearFields()">清空</button>
            <button onclick="navigateToResponse()">转到响应</button>
            <button onclick="copyOutput()">复制</button>
            <button onclick="pasteFromClipboard()">粘貼</button>
        </div>
        <!-- 添加自动跳转选项 -->
        <div class="auto-redirect">
            <input type="checkbox" id="autoRedirect">
            <label for="autoRedirect">自動跳轉</label>
        </div>
        <textarea id="output" rows="5" cols="50" readonly placeholder="绕过后的 URL 将显示在此处..."></textarea>
        <audio id="audioPlayer" controls autoplay loop>
            <!-- ... 音频代码保留 ... -->
        </audio>
    </div>

    <script>
        async function bypassUrl() {
            const urlInput = document.getElementById('urlInput').value;
            const output = document.getElementById('output');

            if (!urlInput) {
                alert('请先输入一个 URL.');
                return;
            }

            try {
                const apiUrl = `https://iwoozie.baby/api/free/bypass?url=${encodeURIComponent(urlInput)}`;
                const response = await fetch(apiUrl);

                if (!response.ok) {
                    throw new Error(`请求失败: ${response.statusText}`);
                }

                const data = await response.json();
                let finalUrl = '';

                if (data.url) {
                    finalUrl = cleanUrl(data.url);
                } else {
                    const urlRegex = /https?:\/\/[^\s"]+/;
                    const urlMatch = JSON.stringify(data).match(urlRegex);
                    finalUrl = urlMatch ? cleanUrl(urlMatch[0]) : null;
                }

                output.value = finalUrl;

                // 自动跳转功能逻辑
                const autoRedirect = document.getElementById('autoRedirect').checked;
                if(autoRedirect && finalUrl) {
                    // 添加延迟让用户感知处理状态
                    setTimeout(() => {
                        window.open(finalUrl, 'auto_redirect');
                        // 或使用替代跳转方式：
                        // window.location.href = finalUrl; // 当前页跳转
                    }, 1500); // 1.5秒延迟跳转
                }

            } catch (error) {
                output.value = `错误: ${error.message}`;
                // 报错时自动停止自动跳转
                document.getElementById('autoRedirect').checked = false;
            }
        }

        // (其他函数 clearFields、navigateToResponse 等保持原样)...

        // 添加新的自动跳转区域样式
        <style>
            .auto-redirect {
                margin: 15px 0;
                padding: 10px;
                background: #333;
                border-radius: 8px;
                width: fit-content;
            }
            .auto-redirect label {
                margin-left: 8px;
                font-size: 0.9em;
                color: #86d0f0;
                cursor: pointer;
            }
            .auto-redirect input[type="checkbox"] {
                accent-color: #64aef2;
                /* 兼容样式 */
                width: 18px;
                height: 18px;
                vertical-align: middle;
            }
        </style>
    </script>
</body>
</html>
